### Redis面试题整理

#### redis为什么选择跳跃表而不是红黑树?

Redis使用跳跃表的地方有两处：

- 实现有序集合键zset
- 集群节点中用作内部数据结构

为什么使用跳跃表而不选择红黑树呢？

- 在做范围查询时候，红黑树比跳跃表操作要复杂一点。在红黑树上，我们找到指定范围的小值后，还需要以中序遍历的顺序继续寻找其他不超过大值的节点。而在跳跃表上进行范围查询就非常简单，只需要在找到小值之后，对第1层链表进行若干步的遍历就可以实现。
- 红黑树的插入和删除操作可能引发子树的调整，逻辑复杂，而跳跃表的插入和删除只涉及相邻节点的修改，操作简单
- 从内存占用上来说，跳跃表比红黑树更灵活一些。一般来说，平衡树每个节点包含2个指针（分别指向左右子树），而skiplist每个节点包含的指针数目平均为1/(1-p)，具体取决于参数p的大小。如果像Redis里的实现一样，取p=1/4，那么平均每个节点包含1.33个指针，比平衡树更有优势。
- 查找单个key，skiplist和平衡树的时间复杂度都为O(log n)，大体相当；而哈希表在保持较低的哈希值冲突概率的前提下，查找时间复杂度接近O(1)，性能更高一些。所以我们平常使用的各种Map或dictionary结构，大都是基于哈希表实现的。
- 从算法实现难度上来比较，skiplist比平衡树要简单得多。